<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Mikayilov Crypto</title>
<style>
    body { font-family: Arial; max-width: 700px; margin: 40px auto; }
    textarea { width: 100%; min-height: 120px; }
    input, button { padding: 10px; margin: 5px 0; width: 100%; }
    .box { border: 1px solid #ccc; padding: 20px; margin-bottom: 20px; border-radius: 10px; }
</style>
</head>
<body>

<h2>üîê Mikayilov Crypto ‚Äì ≈ûifr…ôl…ô / A√ßarla A√ß</h2>

<div class="box">
    <h3>≈ûifr…ôl…ô</h3>
    <textarea id="plain" placeholder="≈ûifr…ôl…ôn…ôc…ôk m…ôtn..."></textarea>
    <input id="key1" type="password" placeholder="A√ßar...">
    <button onclick="encrypt()">≈ûifr…ôl…ô</button>
    <textarea id="cipher" placeholder="≈ûifr…ôl…ônmi≈ü m…ôtn..." readonly></textarea>
</div>

<div class="box">
    <h3>De≈üifr…ôl…ô</h3>
    <textarea id="cipher2" placeholder="≈ûifr…ôl…ônmi≈ü m…ôtn..."></textarea>
    <input id="key2" type="password" placeholder="A√ßar...">
    <button onclick="decrypt()">A√ß</button>
    <textarea id="plain2" placeholder="A√ßƒ±lmƒ±≈ü m…ôtn..." readonly></textarea>
</div>

<script>
async function getKey(password) {
    const enc = new TextEncoder();
    const keyMaterial = await crypto.subtle.importKey(
        "raw", enc.encode(password), {name: "PBKDF2"}, false, ["deriveKey"]
    );
    return crypto.subtle.deriveKey(
        {
            name: "PBKDF2",
            salt: enc.encode("mikayilov-salt"),
            iterations: 500000,
            hash: "SHA-256"
        },
        keyMaterial,
        { name: "AES-GCM", length: 256},
        false,
        ["encrypt", "decrypt"]
    );
}

async function encrypt() {
    const text = document.getElementById("plain").value;
    const password = document.getElementById("key1").value;

    const key = await getKey(password);
    const iv = crypto.getRandomValues(new Uint8Array(12));

    const enc = new TextEncoder();
    const encrypted = await crypto.subtle.encrypt(
        { name: "AES-GCM", iv },
        key,
        enc.encode(text)
    );

    const data = new Uint8Array([...iv, ...new Uint8Array(encrypted)]);
    document.getElementById("cipher").value = btoa(String.fromCharCode(...data));
}

async function decrypt() {
    try {
        const encryptedBase64 = document.getElementById("cipher2").value;
        const password = document.getElementById("key2").value;

        const data = Uint8Array.from(atob(encryptedBase64), c => c.charCodeAt(0));
        const iv = data.slice(0, 12);
        const ciphertext = data.slice(12);

        const key = await getKey(password);
        const decrypted = await crypto.subtle.decrypt(
            { name: "AES-GCM", iv },
            key,
            ciphertext
        );

        const dec = new TextDecoder();
        document.getElementById("plain2").value = dec.decode(decrypted);
    } catch (e) {
        document.getElementById("plain2").value = "‚ùå A√ßar s…ôhvdir v…ô ya m…ôlumat z…ôd…ôlidir.";
    }
}
</script>

</body>
</html>


